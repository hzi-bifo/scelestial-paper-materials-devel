## Convert input-scite (which is generated by synthesis) to all other inputs,
## including BitPhylogeny, Impute.


import sys, itertools, re

sciteFile = open(sys.argv[1])
imputeFile = open(sys.argv[2], "w+")
bpFile = open(sys.argv[3], "w+")

seq = []
for l in sciteFile:
        x = l.strip().split()
        for i, v in enumerate(x):
                while i >= len(seq):
                        seq.append([])
                seq[i].append(int(v))

loc = len(seq[0])
for i in range(loc):
        print("{}".format(i+1), end=" ", file=imputeFile)
        for j in range(len(seq)):
                s = seq[j][i]
                if s == 0: ss = "A/A"
                elif s == 1: ss = "C/C"
                elif s == 2: ss = "A/C"
                elif s == 3: ss = "./."
                else: 
                        print("OH! {}".format(s))
                        raise("OH! {}".format(s))
                print("{}".format(ss), end=" ", file=imputeFile)
        print(file=imputeFile)

for i in range(loc):
        print("V{}".format(i+1), end="", file=bpFile)
        if i != loc - 1:
                print(",", end="", file=bpFile)
print(file=bpFile)

for s in seq:
        first = True
        for v in s:
                if v == 3: v = 2
                # Is the following a good choice for BP?
                elif v == 2: v = 1
                if not first: 
                        print(",", end="", file=bpFile)
                first = False
                print("{}".format(v), end="", file=bpFile)
        print(file=bpFile)
